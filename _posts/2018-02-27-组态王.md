---
layout: post
title: "组态王问题"
date: 2018-02-28
description: "组态王"
tag: 组态王
---
### 组态王6.55和三菱Q06PLC连接问题 
生产线有三个操作台，每台电脑需用组态王上位机和PLC通信，通信连接过程中一直连接不上记录下解决过程

- PLC侧设置，通信采用UDP方式，用GXworks设置时按照组态王的帮助教程里有步骤，在设置PC侧和PLC侧端口号时，PLC侧采用`16进制`设置，PC侧组态王记录的端口号也为16进制，两侧需一样
- PLC侧设完IP后还需对`连接目标`进行设置,设置为以太网模式，具体设置方法参照组态王
- 组态王侧，组态王侧设置时刚开始选的为`中型以太网驱动程序`,设置完后能通讯上，不过记录的不对，因此费了点时间。应该选用`Q系列的以太网模块`,选择串口时随便选择大一点的。

需注意的也就是以上三点，三点设置正确就能正常通信了。
### 组态王和数据库连接
运行组态王时出现`SQL error未发现数据库名称并未指定默认驱动程序`,一直不知道什么原因，最后发现画面中的报表控件没和数据库连接，以及数据库也没建立。跟着教程建立数据库后，在画面中将`KVADODBGrid Class`控件关联数据库时出现`Unable to load odbcji32.dll`错误，在配置数据源时也没有出现错误，最后找到的原因是`数据源odbc,由于计算机64位系统，系统默认菜单控制64位数据源，于是会提示“找不到odbc驱动程序的安装例程”的错误`。解决方法命令指示符运行32位odbc路径。路径：c\Windows\sysWOW64\odbcad32.exe或者找到此路径文件夹运行此程序，在打开的画面中进行配置即可。
### 组态王下拉式列表控件的使用
命令语句的输入是在`画面属性`里的窗口点击`命令语言`输入，具体的命令语言，帮助里面有其用法
### 总结
第一次做的代价就是在来回尝试的过程中发现方法，就是尝试的过程有点曲折，要是有个人帮忙该有多好。。。来来回回还是第一次，没经验可寻的感觉很不好。。。